# 自定义生成任务

工具提供了自定义代码生成任务的功能，允许用户根据特定需求生成代码。本篇介绍如何创建和使用自定义代码生成任务。

代码生成相关功能在导航`代码生成/生成任务`下。

## 创建自定义生成任务

创建生成任务分两步：
1. 创建步骤
2. 创建任务

一个任务可包含多个步骤，每个步骤会有对应的模板和生成路径。

假设我们已有一个示例模板，如果没有请参考[代码模板](../数据管理/代码模板.md)创建一个。

### 创建步骤

点击步骤列表右侧的 + 按钮，进入创建步骤页面：

![创建任务步骤](../../_images/create_task_step.png)

- 你只能选择一个模板文件
- 当你是基于某个模型生成代码时，你可以在输出目录中使用支持的变量。
  

### 创建任务

点击任务列表右侧的 + 按钮，进入创建任务页面：

![创建任务](../../_images/create_task.png)

上下文类型用于指定代码生成时所使用的数据类型，包括:

1. 实体(Entity)，常用在根据实体生成dto，或生成Sql脚本，或进行转换等。
2. DTO模型(DTO Model)，如生成请求模型，响应模型，以及前端页面等。
3. OpenAPI，会提供`OpenApiPaths`对象来暴露接口相关信息。你需要熟悉[OpenAPI.NET](https://github.com/microsoft/OpenAPI.NET)，以便在模板中使用。
4. 你可以添加自定义变量，以便在模板中使用。

### 运行任务

创建完成后，返回任务列表，点击运行按钮，会根据你选择的上下文类型，让你选择合适的数据来源(可进行搜索)，比如某个实体或配置好的OpenApi结点。

## 总结

自定义代码生成，可以让你根据后端提供的实体或DTO模型信息，生成你需要的代码，以便减少重复性的工作，减少人为错误。

不过你需要你有一定的`razor`模板编写基础。强烈建议，直接使用`VS Code` 来编写`razor`文件，它可以提供语法高亮和代码补全功能。

后续，我们借助AI来帮助生成代码模板。