# 多语言支持

多语言支持是框架的默认实现，你可以在`WebExtensions.cs`中的`AddLocalizer`找到相关的服务配置。

> [!NOTE]
> 多语言的支持基于`ASP.NET Core`的全球化与本地化功能，具体的使用可以参考[ASP.NET Core 全球化与本地化](https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/localization/?view=aspnetcore-10.0)。

## 使用多语言

在`Definition/Share`项目中，你能看到多语言相关的资源文件，在VS中通常会被折叠到`Localizer.cs`文件下。

打开任意的资源文件，添加或修改对应的键值对即可。

添加完成后，`Perigon.AspNetCore.SourceGeneration`源代码生成器会自动在`Localizer`中生成对应的常量(partial class)。

你可以在任何需要使用多语言的地方，注入`Localizer localizer`,它是对`IStringLocalizer<Localizer>`的封装:

```csharp
public partial class Localizer(IStringLocalizer<Localizer> localizer)
{
    public string Get(string key, params object[] arguments)
    {
        try
        {
            return localizer[key, arguments];
        }
        catch (Exception)
        {
            return key;
        }
    }
}
```

默认控制器都会继承自`RestControllerBase`，需要注入了`Localizer`，基类对常见的MVC方法，如`BadRequest`,`NotFound`等进行了重写，以支持多语言，你可以非常方便的调用：

```csharp
return BadRequest(Localizer.UserNotFound);
```

而在`Manager`业务实现类中，内容可以通过抛出`BusinessException`来实现多语言支持，如.

```csharp
throw new BusinessException(Localizer.UserNotFound);
```

`GlobalExceptionMiddleware`会捕获该异常，并将多语言内容返回给客户端。
