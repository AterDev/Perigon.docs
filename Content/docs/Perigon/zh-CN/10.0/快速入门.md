# 快速入门

本篇文章帮助您快速创建和运行项目。

## 前提条件

1. 安装 `.NET 10` 或更高版本的 SDK。
2. 安装 `Docker Desktop` 或 `Podman`。
3. 安装 `.NET Aspire 13.0+` 组件。

具体要求请参考 [.NET Aspire Setup](https://aspire.dev/get-started/prerequisites/)。

> [!TIP]
> 可以直接安装 `Visual Studio 2026`，选择 `ASP.NET Core` 工作负载，它已经集成了 `.NET 10 SDK` 和 `.NET Aspire` 组件。

## 安装工具

使用 `dotnet tool` 命令安装 `Perigon.CLI` 工具。

```powershell
dotnet tool install Perigon.CLI --version 10.0.0
```

版本请以 `nuget.org` 上的最新版本为准。

## 创建解决方案

首先打开终端，执行以下命令，以在浏览器中启用管理界面。

```powershell
perigon studio
```

点击`创建解决方案`按钮，进入创建解决方案的界面。

![create-solution](./_images/create_solution.jpg)

输入相关信息后，点击`创建解决方案`按钮，等待创建完成。

## 查看解决方案

打开解决方案，在 src 目录下，可以看到代码结构。

找到 `AppHost` 项目，后续将主要使用它来运行项目。

模板默认包含了 `SystemMod` 模块，用来提供基础的用户/角色/权限管理功能，以提供参考和代码示例。

关于目录的详细说明请参考[目录结构](./项目模板/目录结构.md)。

> [!NOTE]
> 如果不需要默认模块，建议通过 Studio 来删除，它将帮助您正确地移除模块及其相关依赖。

## 运行项目

### 创建数据库迁移

首次运行项目，或对EF Core实体进行了更改，需要先创建数据库迁移。

在根目录 `scripts` 下，调用 `EFMigrations.ps1` 脚本来执行数据库的迁移，如：

```powershell
.\EFMigrations.ps1 Init
```

该脚本会使用 `dotnet ef` 命令来执行数据库迁移，迁移生成的内容将在 `Definition/EntityFramework/Migrations` 目录下。


> [!NOTE]
> 请使用 `PowerShell 7` 及以上版本，它是跨平台的。在 Windows 上您需要开启执行策略，运行 `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser` 命令来设置。

### 启动 AppHost 项目

接下来，让我们运行 `AppHost` 项目。您可以使用 VS 或命令 `dotnet run` 来运行该项目。但在此之前，您需要先确保 `Docker` 或 `Podman` 已经运行，以便 Aspire 能够拉取相应的镜像。

现在，先放松一下 ☕，首次运行会下载一些镜像和依赖，这将花费一些时间。

在 Aspire 准备就绪后，会自动打开浏览器，您将看到 `Dashboard` 页面，我们可以清楚地看到基础设施和服务的运行状态。

![alt text](./_images/dashboard.jpg)

关于 `Dashboard` 的功能和使用，请参考[微软官方文档](https://learn.microsoft.com/en-us/dotnet/aspire/fundamentals/dashboard)。

> [!TIP]
> 如果启动时遇到 HTTPS 或证书问题，请尝试运行 `dotnet dev-certs https -t` 命令来信任开发证书。

> [!TIP]
> 如果您在 .NET Aspire Console 中遇到乱码问题，请到控制面板的区域设置中，设置使用 UTF-8 提供全球语言支持。

## 了解项目模板

通过 `Dashboard`，我们可以直观地看到依赖的基础环境和服务项目，以下简要说明各项目：

- MigrationService：用于执行数据库迁移和初始化数据的服务，主要用在开发阶段，执行完后会自动退出。
- ApiService：提供面向客户端的 API 接口服务。
- AdminService：提供后台管理需要的接口服务，默认依赖 `SystemMod`，首次运行时会初始化管理员账号和密码。
- frontend：Angular 前端项目，提供简单的后台示例。

您可以在这些服务的基础上开发自己的业务逻辑，也可以删除它们，创建新的服务项目。

> [!TIP]
> 关于项目模板的详细内容，请参考[项目模板](./项目模板/概述.md)。

## 测试项目

程序运行起来后，我们可以通过面板查看是否有异常，并通过控制台查看具体的错误信息。如果一切正常，我们可以测试一下接口。

### 查看 Swagger 内容
如果 `AdminService` 是 `Running` 状态，那么表示正常运行。我们先看一下 `Swagger` 是否正常，直接点击服务的 URL 地址，进入 Swagger 页面。

### 请求接口

找到 `AdminService` 下的 `AdminService.http` 文件，这里有获取 Token 和获取用户信息两个接口，请依次点击，并查看返回内容。


### 从前端项目登录

默认情况下，Aspire 会启动 Angular 前端项目，在 Dashboard 中，可以直接点击链接，进入前端页面，使用以下信息进行登录：
- 邮箱：`admin@default.com`
- 密码：`Perigon.2026`

### 运行测试项目

您也可以通过运行测试项目来测试接口。**请先停止当前的 Aspire 服务**，然后找到 `ApiTest` 项目，在 VS 中按 F5 运行它，或在命令行中执行 `dotnet test` 运行它。

默认的测试项目是集成测试项目，不是单元测试项目。运行时，它会启动 `Aspire` 实例，将所有服务运行起来，模拟实际运行环境，然后执行测试用例。


使用以上任意一种方式都可以验证我们的服务是否正常运行。

## 接下来

1. 了解项目结构和配置，阅读[项目模板](./项目模板/概述.md)。
2. 阅读[开发规范与约定](./最佳实践/开发规范与约定.md)。
3. 学习使用代码生成器，快速进行模块开发，参阅[使用代码生成](./教程/使用代码生成.md)。